var __awaiter=this&&this.__awaiter||function(t,l,s,d){return new(s=s||Promise)(function(o,e){function i(t){try{n(d.next(t))}catch(t){e(t)}}function r(t){try{n(d.throw(t))}catch(t){e(t)}}function n(t){var e;t.done?o(t.value):((e=t.value)instanceof s?e:new s(function(t){t(e)})).then(i,r)}n((d=d.apply(t,l||[])).next())})};function getSeekingAlphaPortfolio(){return __awaiter(this,void 0,void 0,function*(){var t=document.querySelector('[data-test-id="default-portfolio-tickers"] table');if(!t)return console.log("No container found"),[];console.log("Container: ",t);t=t.querySelectorAll("tbody tr");const r=[];return t.forEach(t=>{var e,o,i=null==(i=t.querySelector('[data-test-id="portfolio-ticker-name"]'))?void 0:i.innerText;i?(o=t.querySelectorAll("td")).length<5?console.error("Not enough tds in row",o.length):(e=o[4].innerText,o=o[5].innerText,r.push({symbol:i,avg_open:parseFloat(o),units:parseFloat(e)})):console.log("No ticker name found in row",t)}),r})}function getTickersAddUpdateRemove(t,r){return __awaiter(this,void 0,void 0,function*(){let i={add:[],update:[],remove:[],unchanged:[]};function o(t,e,o){return t.toFixed(o)===e.toFixed(o)}return t.forEach(e=>{let o=!1;r.forEach(t=>{e.symbol===t.symbol&&(o=!0)}),o||i.add.push(e)}),t.forEach(e=>{r.forEach(t=>{e.symbol===t.symbol&&o(e.units,t.units,2)&&o(e.avg_open,t.avg_open,2)&&i.update.push({etoro:e,seeking:t})})}),r.forEach(e=>{let o=!1;t.forEach(t=>{t.symbol===e.symbol&&(o=!0)}),o||i.remove.push(e)}),t.forEach(e=>{r.forEach(t=>{e.symbol===t.symbol&&o(e.units,t.units,2)&&o(e.avg_open,t.avg_open,2)&&i.unchanged.push(t)})}),i})}function wait_for_selector_exists(e){return __awaiter(this,void 0,void 0,function*(){let t=null;for(;null===t;){if(t=document.querySelector(e))return t;yield new Promise(t=>setTimeout(t,100))}return null})}function wait_for_first_selector_that_exists(i){return __awaiter(this,void 0,void 0,function*(){for(var e={result:null,query_idx:0};null===e.result;){for(let t=0;t<i.length;t++){var o=document.querySelector(i[t]);if(o)return e.result=o,e.query_idx=t,e}yield new Promise(t=>setTimeout(t,100))}return e})}const doAddSymbol=e=>__awaiter(void 0,void 0,void 0,function*(){var t=document.querySelector("[data-test-id='add-symbols-button']");t?(t.click(),(t=yield wait_for_selector_exists("[data-test-id='modal-content'] input[data-test-id='text-input']"))?(t.value=e,t=wait_for_first_selector_that_exists(["[data-test-id='result-list-title']","[data-test-id='help-label']"]),console.log(t)):console.error("Could not find search input")):console.error("Could not find add symbol button")}),doEditSymbol=t=>__awaiter(void 0,void 0,void 0,function*(){var t=document.querySelector("[data-test-id='edit-portfolio-button']");if(t){t.click();t=yield wait_for_selector_exists("[data-test-id='symbols-list']");if(t){var e=[];for(const o of t.querySelectorAll("[data-test-id='ticker-name-label']"))e.push(o.innerText)}else console.error("Could not find edit symbols list")}else console.error("Could not find edit symbol button")});window.getSeekingAlphaPortfolio=getSeekingAlphaPortfolio,window.getTickersAddUpdateRemove=getTickersAddUpdateRemove,window.doAddSymbol=doAddSymbol,window.doEditSymbol=doEditSymbol,window.wait_for_selector_exists=wait_for_selector_exists,window.wait_for_first_selector_that_exists=wait_for_first_selector_that_exists;