var __awaiter=this&&this.__awaiter||function(o,l,a,u){return new(a=a||Promise)(function(e,t){function n(o){try{i(u.next(o))}catch(o){t(o)}}function r(o){try{i(u.throw(o))}catch(o){t(o)}}function i(o){var t;o.done?e(o.value):((t=o.value)instanceof a?t:new a(function(o){o(t)})).then(n,r)}i((u=u.apply(o,l||[])).next())})};const ETORO_TO_SA_MAPPING={"BA.L":{sa_name:"BAESY",conversion_rate:71.24/1384}};function mapEtoroToSASymbol(o){return ETORO_TO_SA_MAPPING[o]}function getEtoroContainer(){return __awaiter(this,void 0,void 0,function*(){var o="et-portfolio-group-list";let t=null;for(;null===t||0==t.length;)t=document.getElementsByTagName(o),yield new Promise(o=>setTimeout(o,1e3));return console.log("Found etoro portoflio container with tag "+o),console.log(t[0]),t[0]})}function getEtoroPortfolio(){return __awaiter(this,void 0,void 0,function*(){console.log("Requesting etoro portfolio");var o=(yield getEtoroContainer()).querySelectorAll('[automation-id="watchlist-grid-instruments-list"]');const i=[];return o.forEach(t=>{var e=null==(e=t.querySelector('[automation-id="portfolio-overview-table-body-cell-avg-open-rate"]'))?void 0:e.innerText;let n=null==(r=t.querySelector('[automation-id="portfolio-overview-table-body-cell-market-name"]'))?void 0:r.innerText;t=null==(r=t.querySelector('[automation-id="portfolio-overview-table-body-cell-units-value"]'))?void 0:r.innerText;if(t&&e&&n){let o=parseFloat(e);var r=parseFloat(t),e=mapEtoroToSASymbol(n);e&&(n=e.sa_name,o*=e.conversion_rate),i.push({avg_open:o,symbol:n,units:r})}}),i.filter(o=>!!o.units)})}window.getEtoroPortfolio=getEtoroPortfolio;